
                               EMBOSS: water
     _________________________________________________________________
   
                                 Program water
                                       
Function

   Smith-Waterman local alignment
   
Description

   water uses the Smith-Waterman algorithm (modified for speed
   enhancments) to calculate the local alignment.
   
   The Smith-Waterman algorithm is a member of the class of algorithms
   that can calculate the best score and local alignment in the order of
   mn steps, (where 'n' and 'm' are the lengths of the two sequences).
   These dynamic programming algorithms were first developed for protein
   sequence comparison by Smith and Waterman, though similar methods were
   independently devised during the late 1960's and early 1970's for use
   in the fields of speech processing and computer science.
   
   What is the optimal local alignment? Dynamic programming methods
   ensure the optimal local alignment by exploring all possible
   alignments and choosing the best. It does this by reading in a scoring
   matrix that contains values for every possible residue or nucleotide
   match. water finds an alignment with the maximum possible score where
   the score of an alignment is equal to the sum of the matches taken
   from the scoring matrix.
   
   An important problem is the treatment of gaps, i.e., spaces inserted
   to optimise the alignment score. A penalty is subtracted from the
   score for each gap opened (the 'gap open' penalty) and a penalty is
   subtracted from the score for the total number of gap spaces
   multiplied by a cost (the 'gap extension' penalty).
   
   Typically, the cost of extending a gap is set to be 5-10 times lower
   than the cost for opening a gap.
   
Usage

   Here is a sample session with water.

% water sw:hba_human sw:hbb_human
Gap opening penalty [10.0]:
Gap extension penalty [0.5]:
Output file [hba_human.water]:

Command line arguments

   Mandatory qualifiers:
  [-sequencea]         sequence   Sequence USA
  [-seqall]            seqall     Sequence database USA
   -gapopen            float      Gap opening penalty
   -gapextend          float      Gap extension penalty
  [-outfile]           outfile    Output file name

   Optional qualifiers:
   -datafile           matrixf    Matrix file
   -showinternals      bool       Show internals

   Advanced qualifiers: (none)
   
   Mandatory qualifiers Allowed values Default
   [-sequencea]
   (Parameter 1) Sequence USA Readable sequence Required
   [-seqall]
   (Parameter 2) Sequence database USA Readable sequence(s) Required
   -gapopen Gap opening penalty Number from 1.000 to 100.000 10.0 for any
   sequence
   -gapextend Gap extension penalty Number from 0.100 to 10.000 0.5 for
   any sequence
   [-outfile]
   (Parameter 3) Output file name Output file <sequence>.water
   Optional qualifiers Allowed values Default
   -datafile Matrix file Comparison matrix file in EMBOSS data path
   EBLOSUM62 for protein
   EDNAMAT for DNA
   -showinternals Show internals Yes/No No
   Advanced qualifiers Allowed values Default
   (none)
   
Input file format

   Any two sequence USAs of the same type (DNA or protein).
   
Output file format

   Here is the output file from the example run:
     _________________________________________________________________
   
Local: HBA_HUMAN vs HBB_HUMAN
Score: 293.50

HBA_HUMAN       2        LSPADKTNVKAAWGKVGAHAGEYGAEALERMFLSFPTTKTYFPHF 46
                         |:| :|: | | ||||  :  | | ||| |: : :| |: :|  |
HBB_HUMAN       3        LTPEEKSAVTALWGKV..NVDEVGGEALGRLLVVYPWTQRFFESF 45

HBA_HUMAN       47       .DLS.....HGSAQVKGHGKKVADALTNAVAHVDDMPNALSALSD 85
                          |||      |: :|| |||||  | :: :||:|::    : ||:
HBB_HUMAN       46       GDLSTPDAVMGNPKVKAHGKKVLGAFSDGLAHLDNLKGTFATLSE 90

HBA_HUMAN       86       LHAHKLRVDPVNFKLLSHCLLVTLAAHLPAEFTPAVHASLDKFLA 130
                         ||  || ||| ||:|| : |:  || |   |||| | |:  | :|
HBB_HUMAN       91       LHCDKLHVDPENFRLLGNVLVCVLAHHFGKEFTPPVQAAYQKVVA 135

HBA_HUMAN       131      SVSTVLTSKY                                    140
                          |:  |  ||
HBB_HUMAN       136      GVANALAHKY
     _________________________________________________________________
   
Data files

   For protein sequences EBLOSUM62 is used for the substitution matrix.
   For nucleotide sequence, EDNAMAT is used. Others can be specified.
   
   EMBOSS data files are distributed with the application and stored in
   the standard EMBOSS data directory, which is defined by EMBOSS
   environment variable EMBOSS_DATA.
   
   Users can provide their own data files in their own directories.
   Project specific files can be put in the current directory, or for
   tidier directory listings in a subdirectory called ".embossdata".
   Files for all EMBOSS runs can be put in the user's home directory, or
   again in a subdirectory called ".embossdata".
   
   The directories are searched in the following order:
     * . (your current directory)
     * .embossdata (under your current directory)
     * ~/ (your home directory)
     * ~/.embossdata
       
Notes

   water is a true implementation of the Smith-Waterman algorithm and so
   produces a full path matrix. It therefore cannot be used with genome
   sized sequences unless you have a lot of memory and a lot of time.
   
References

    1. Smith TF, Waterman MS (1981) J. Mol. Biol 147(1);195-7
       
Warnings

   water is for aligning the best matching subsequences of two sequences.
   It does not necessarily align whole sequences against each other; you
   should use water if you wish to align closely related sequenecs along
   their whole lengths.
   
   The memory and time required to do the search is proportional to (on
   the order of) mn, where 'n' and 'm' are the lengths of the two
   sequences. This means that aligning two 1000-residue sequences takes
   roughly 100 times longer and uses 100 times more memory than aligning
   two 100-residue sequences.
   
Diagnostic Error Messages

Uncaught exception
 Assertion failed
 raised at ajmem.c:xxx

   Probably means you have run out of memory. Try using supermatcher or
   stretcher if this happens.
   
Exit status

   0 if successfull.
   
Known bugs

   None.
   
See also

   Program name                      Description
   matcher      Finds the best local alignments between two sequences
   
Author(s)

   This application was written by Alan Bleasby (ableasby@hgmp.mrc.ac.uk)
   
History

Completed 7th July 1999.
Last modified 27th July 1999.

Target users

   This program is intended to be used by everyone and everything, from
   naive users to embedded scripts.
   
Comments
