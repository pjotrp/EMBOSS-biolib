
                                 contacts 



Function

   Reads CCF files (clean coordinate files) and writes CON files (contact
   files) of intra-chain residue-residue contact data

Description

   This program is part of a suite of EMBOSS applications that directly
   or indirectly make use of the protein structure databases pdb and
   scop. This program is part of an experimental analysis pipeline
   described in an accompanying document. We provide the software in the
   hope that it will be useful. The applications were designed for
   specific research purposes and may not be useful or reliable in
   contexts other than the described pipeline. The development of the
   suite was coordinated by Jon Ison to whom enquiries and bug reports
   should be sent (email jison@hgmp.mrc.ac.uk). ** Knowledge of the
   physical contacts that amino acid residues within a protein or domain
   make with one another is required for several different analyses.
   contacts calculates intra-chain residue-residue contact data from
   protein and domain coordinate files.

Algorithm

   Contact between two residues is defined as when the van der Waals
   surface of any atom of the first residue comes within the threshold
   contact distance of the van der Waals surface of any atom of the
   second residue. The threshold contact distance is a user-defined
   distance with a default value of 1 Angstrom.

Usage

Command line arguments

   Standard (Mandatory) qualifiers:
  [-cpdb]              dirlist    This option specifies the location of CCF
                                  files (clean coordinate files) (input). A
                                  'clean cordinate file' contains protein
                                  coordinate and derived data for a single PDB
                                  file ('protein clean coordinate file') or a
                                  single domain from SCOP or CATH ('domain
                                  clean coordinate file'), in CCF format
                                  (EMBL-like). The files, generated by using
                                  PDBPARSE (PDB files) or DOMAINER (domains),
                                  contain 'cleaned-up' data that is
                                  self-consistent and error-corrected. Records
                                  for residue solvent accessibility and
                                  secondary structure are added to the file by
                                  using PDBPLUS.
   -vdwf               datafile   This option specifies the name of the data
                                  file with van der Waals radii of atoms for
                                  different amino acid residues.
   -thresh             float      Contact between two residues is defined as
                                  when the van der Waals surface of any atom
                                  of the first residue comes within the
                                  threshold contact distance of the van der
                                  Waals surface of any atom of the second
                                  residue. The threshold contact distance is a
                                  user-defined distance with a default value
                                  of 1 Angstrom.
  [-con]               directory  This option specifies the location of CON
                                  files (contact files) (output). A 'contact
                                  file' contains contact data for a protein or
                                  a domain from SCOP or CATH, in the CON
                                  format (EMBL-like). The contacts may be
                                  intra-chain residue-residue, inter-chain
                                  residue-residue or residue-ligand. The files
                                  are generated by using CONTACTS, INTERFACE
                                  and FUNKY.
   -conerrf            outfile    The log file contains messages about any
                                  errors arising while contacts ran.

   Additional (Optional) qualifiers:
   -[no]ccfnaming      boolean    This option specifies whether to use pdbid
                                  code to name the output files. If set, the
                                  PDB identifier code (from the PDB file) is
                                  used to name the file. Otherwise, the output
                                  files have the same names as the input
                                  files.
   -skip               boolean    Whether to calculate contacts between
                                  residue adjacent in sequence.
   -ignore             float      If any two atoms from two different residues
                                  are at least this distance apart then no
                                  futher inter-atomic contacts will be checked
                                  for for that residue pair . This speeds the
                                  calculation up considerably.

   Advanced (Unprompted) qualifiers: (none)
   Associated qualifiers:

   "-conerrf" associated qualifiers
   -odirectory         string     Output directory

   General qualifiers:
   -auto               boolean    Turn off prompts
   -stdout             boolean    Write standard output
   -filter             boolean    Read standard input, write standard output
   -options            boolean    Prompt for standard and additional values
   -debug              boolean    Write debug output to program.dbg
   -verbose            boolean    Report some/full command line options
   -help               boolean    Report command line options. More
                                  information on associated and general
                                  qualifiers can be found with -help -verbose
   -warning            boolean    Report warnings
   -error              boolean    Report errors
   -fatal              boolean    Report fatal errors
   -die                boolean    Report deaths


   Standard (Mandatory) qualifiers Allowed values Default
   [-cpdb]
   (Parameter 1) This option specifies the location of CCF files (clean
   coordinate files) (input). A 'clean cordinate file' contains protein
   coordinate and derived data for a single PDB file ('protein clean
   coordinate file') or a single domain from SCOP or CATH ('domain clean
   coordinate file'), in CCF format (EMBL-like). The files, generated by
   using PDBPARSE (PDB files) or DOMAINER (domains), contain 'cleaned-up'
   data that is self-consistent and error-corrected. Records for residue
   solvent accessibility and secondary structure are added to the file by
   using PDBPLUS. Directory with files ./
   -vdwf This option specifies the name of the data file with van der
   Waals radii of atoms for different amino acid residues. Data file
   Evdw.dat
   -thresh Contact between two residues is defined as when the van der
   Waals surface of any atom of the first residue comes within the
   threshold contact distance of the van der Waals surface of any atom of
   the second residue. The threshold contact distance is a user-defined
   distance with a default value of 1 Angstrom. Any numeric value 1.0
   [-con]
   (Parameter 2) This option specifies the location of CON files (contact
   files) (output). A 'contact file' contains contact data for a protein
   or a domain from SCOP or CATH, in the CON format (EMBL-like). The
   contacts may be intra-chain residue-residue, inter-chain
   residue-residue or residue-ligand. The files are generated by using
   CONTACTS, INTERFACE and FUNKY. Directory ./
   -conerrf The log file contains messages about any errors arising while
   contacts ran. Output file contacts.log
   Additional (Optional) qualifiers Allowed values Default
   -[no]ccfnaming This option specifies whether to use pdbid code to name
   the output files. If set, the PDB identifier code (from the PDB file)
   is used to name the file. Otherwise, the output files have the same
   names as the input files. Boolean value Yes/No Yes
   -skip Whether to calculate contacts between residue adjacent in
   sequence. Boolean value Yes/No No
   -ignore If any two atoms from two different residues are at least this
   distance apart then no futher inter-atomic contacts will be checked
   for for that residue pair . This speeds the calculation up
   considerably. Any numeric value 20.0
   Advanced (Unprompted) qualifiers Allowed values Default
   (none)

Input file format

   contacts reads any normal sequence USAs.

   The format of the clean coordinate file is described in pdbparse

Output file format

   contacts reads a directory of domain or protein coordinate files and
   writes a contacts file of intra-chain residue-residue contact data in
   embl-like format for each file in the input directory. Each output
   file contains residue contact data for every chain of every model in a
   protein coordinate file, or contact data for the single scop domain
   where a domain coordinate file is read. The paths and extensions for
   the coordinate (input) and contact (output) files are specified by the
   user. The scop domain or pdb identifier codes are used as appropriate
   to name the output files. A log file is also written.

   The embl-like format used for the contact files (below) uses the
   following records:

   (1) ID - either the 4-character PDB identifier code (where clean
   protein coordinate files are used as input) or the 7-character domain
   identifier code taken from scop (where domain coordinate files were
   used as input; see documentation for the EMBOSS application scope for
   further info.)

   (2) DE - bibliographic information. The text "Residue-residue contact
   data" is always given.

   (4) EX - experimental information. The value of the threshold contact
   distance is given as a floating point number after 'THRESH'. The
   number of models and number of polypeptide chains are given after
   'NMOD' and 'NCHA' respectively. domain coordinate files a 1 is always
   given. Following the EX record, the file will have a section
   containing a CN, IN and SM records (see below) for each chain. The
   sections for each chain of a model are given after the MO record.

   (5) MO - model number. The number given in brackets after this record
   indicates the start of a section of model-specific data.

   (6) CN - chain number. The number given in brackets after this record
   indicates the start of a section of chain-specific data.

   (7) IN - chain specific data. The character given after ID is the PDB
   chain identifier taken from the input file, (a '.` given in cases
   where a chain identifier was not specified in the original pdb file
   or, for domain coordinate files, the domain is comprised of more than
   one domain). The number of amino acid residues comprising the chain
   (or the chains from which a domain is comprised) is given after NR.
   The number of residue-residue contacts is given after NSMCON.

   (8) SM - Line of residue contact data. Pairs of amino acid identifiers
   and residue numbers are delimited by a ';'. Residue numbers are taken
   from the clean coordinate file and give a correct index into the
   sequence (i.e. they are not necessarily the same as the original pdb
   file).

   (9) XX - used for spacing.

   (10) // - given on the last line of the file only.

   Note - SM records are used for contacts between either either
   side-chain or main-chain atoms as defined above. In a future
   implementation, SS will be used for side-chain only contacts, MM will
   be used for main-chain only contacts, and there will probably be
   several other forms of contact too.

   Excerpt from contacts output file

ID   D1HBBB_
XX
DE   Residue-residue side-chain contact data
XX
EX   THRESH 10.0; NMOD 1; NCHA 1;
XX
MO   [1]
XX
CN   [1]
XX
IN   ID B; NR 146; NSMCON 2514;
XX
SM   VAL 1 ; HIS 2
SM   VAL 1 ; LEU 3
SM   VAL 1 ; THR 4
SM   VAL 1 ; PRO 5
SM   VAL 1 ; GLU 6
SM   VAL 1 ; GLU 7
SM   VAL 1 ; LYS 8
SM   VAL 1 ; VAL 11
SM   VAL 1 ; PHE 71

Data files

   contacts uses a data file containing van der Waals radii for atoms in
   proteins (below). The file Evdw.dat is such a data file and is part of
   the emboss distribution.

DE   File of van der Waals radii for atoms in proteins
XX
NR   24
XX
AA   ALA
XX
ID   A
XX
NN   12
XX
AT   N    ; 1.7
AT   CA   ; 1.9
AT   C    ; 1.7
AT   O    ; 1.4
AT   CB   ; 1.9
AT   OXT  ; 1.4
AT   H    ; 1.2
AT   OH   ; 1.4
AT   HA   ; 1.2
AT   HB   ; 1.2
AT   HG   ; 1.2
AT   D    ; 1.2
//
AA   ARG
XX
ID   R
XX
NN   31
XX
AT   N    ; 1.7
AT   CA   ; 1.9
AT   C    ; 1.7
AT   O    ; 1.4
AT   N    ; 1.7
**
< data ommitted for clarity >
**
//
AA   XAA
XX
ID   X
XX
NN   6
XX
AT   C    ; 1.9
AT   N    ; 1.7
AT   O    ; 1.4
AT   H    ; 1.2
AT   S    ; 1.8
AT   D    ; 1.2
//

Notes

   None.

References

   None.

Warnings

   None.

Diagnostic Error Messages

   contacts generates a log file an excerpt of which is shown (below). If
   there is a problem in processing a coordinate file, three lines
   containing the record '//', the scop domain or pdb identifier code and
   an error message respectively are written. The text 'WARN file open
   error filename', 'ERROR file read error filename' or 'ERROR file write
   error filename ' will be reported when an error was encountered during
   a file open, read or write respectively. Various other error messages
   may also be given (in case of difficulty email Jon Ison,
   jison@hgmp.mrc.ac.uk).

Excerpt of log file
//
DS002__
WARN  Could not open for reading cpdb file s002.pxyz
//
DS003__
WARN  Could not open for reading cpdb file s003.pxyz

Exit status

   It always exits with status 0.

Known bugs

   None.

See also

   Program name Description
   contactcount Counts specific versus non-specific contacts in a
   directory of cleaned protein chain contact files
   domainalign Generates DAF files (domain alignment files) of
   structure-based sequence alignments for nodes in a DCF file (domain
   classification file)
   domainrep Reorder DCF file (domain classification file) so that the
   representative structure of each user-specified node is given first
   domainreso Removes low resolution domains from a DCF file (domain
   classification file)
   interface Reads CCF files (clean coordinate files) and writes CON
   files (contact files) of inter-chain residue-residue contact data
   libgen Generates various types of discriminating elements for each
   alignment in a directory
   psiphi Calculates phi and psi torsion angles from cleaned EMBOSS-style
   protein co-ordinate file
   rocon Reads a DHF file (domain hits file) of hits (sequences of
   unknown structural classification) and a DHF file of validation
   sequences (known classification) and writes a 'hits file' for the
   hits, which are classified and rank-ordered on the basis of score
   rocplot Provides interpretation and graphical display of the
   performance of discriminating elements (e.g. profiles for protein
   families). rocplot reads file(s) of hits from discriminator-database
   search(es), performs ROC analysis on the hits, and writes graphs
   illustrating the diagnostic performance of the discriminating elements
   seqalign Reads a DAF file (domain alignment file) and a DHF file
   (domain hits file) and writes a DAF file extended with the hits
   seqfraggle Removes fragments from DHF files (domain hits files) or
   other files of sequences
   seqsearch Generate database hits (sequences) for nodes in a DCF file
   (domain classification file) by using PSI-BLAST
   seqsort Reads DHF files (domain hits files) of database hits
   (sequences) and removes hits of ambiguous classification
   seqwords Generates DHF files (domain hits files) of database hits
   (sequences) for nodes in a DCF file (domain classification file) by
   keyword search of UniProt
   siggen Generates a sparse protein signature from an alignment and
   residue contact data
   sigscan Generates a DHF file (domain hits file) of hits (sequences)
   from scanning a signature against a sequence database

   A 'protein coordinate file' contains protein coordinate and other data
   extracted from a single pdb file. The files, generated by pdbparse,
   are in embl-like format and contain 'cleaned-up' data that is
   self-consistent and error-corrected.

   A 'domain coordinate file' contains coordinate and other data for a
   single scop domain. The files are generated by domainer and are in
   embl-like and pdb formats.

   siggen uses contacts files as input.

Author(s)

   Jon Ison (jison © rfcgr.mrc.ac.uk)
   MRC Rosalind Franklin Centre for Genomics Research Wellcome Trust
   Genome Campus, Hinxton, Cambridge, CB10 1SB, UK

History

   Written (2003) - Jon Ison

Target users

   This program is intended to be used by everyone and everything, from
   naive users to embedded scripts.
