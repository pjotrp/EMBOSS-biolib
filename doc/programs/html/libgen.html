<!-- START OF HEADER -->
<HTML><HEAD>
<TITLE> EMBOSS: LIBGEN documentation. </TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" text="#000000">
<H2> LIBGEN documentation </H2>
<!-- END OF HEADER -->





<!-- CONTENTS
     This always includes the sections below.
     Other subsections can be added for individual applications.
-->
<br><H2>CONTENTS </H2>
<b> <a href="#1.0">1.0     SUMMARY                   </a></b><br>
<b> <a href="#2.0">2.0     INPUTS & OUTPUTS          </a></b><br>
<b> <a href="#3.0">3.0     INPUT FILE FORMAT         </a></b><br>
<b> <a href="#4.0">4.0     OUTPUT FILE FORMAT        </a></b><br>
<b> <a href="#5.0">5.0     DATA FILES                </a></b><br>
<b> <a href="#6.0">6.0     USAGE                     </a></b><br>    
<b> <a href="#7.0">7.0     KNOWN BUGS & WARNINGS     </a></b><br>    
<b> <a href="#8.0">8.0     NOTES                     </a></b><br>
<b> <a href="#9.0">9.0     DESCRIPTION               </a></b><br>
<b> <a href="#10.0">10.0   ALGORITHM                 </a></b><br>
<b> <a href="#11.0">11.0   RELATED APPLICATIONS      </a></b><br>
<b> <a href="#12.0">12.0   DIAGNOSTIC ERROR MESSAGES </a></b><br>
<b> <a href="#13.0">13.0   AUTHORS                   </a></b><br>
<b> <a href="#14.0">14.0   REFERENCES                </a></b><br>

<!-- SUMMARY
     Succint description of the application, particularly its inputs, outputs
     and what it does.  The same text is given at the top of the source (.c)
     file and in the <documentation> attribute of the <application definition>
     of the ACD file.
-->
<a name="1.0"></a>
<br><br><br><H2> 1.0   SUMMARY  </H2>
Generates various types of discriminating elements for each alignment in a directory.





<!-- INPUTS & OUTPUTS
     Short summary of the application inputs and outputs in its different 
     modes of usage (if appropriate). More detail than the summary.
-->
<a name="2.0"></a>
<br><br><br><H2> 2.0   INPUTS & OUTPUTS          </H2>
LIBGEN reads a directory of alignments (typically DAF files -  domain alignments file) and generates one of six types of profile for each alignment.  Supported profiles include simple frequency matrices, Gribskov profiles, Hennikoff profiles, HMMs: hidden Markov models (HMMER package), HMMs (SAM-T2K package) and PSSMs: position-specific scoring matrices (PSIBLAST).
<br><br>The base name of an input file is used as the base name for the output file. The paths and extensions for the alignment (input) and profile (output) files are provided by the user. 


<!-- INPUT FILE FORMAT 
     Description and example(s) of input file formats.  Should provide enough
     information to write and parse the file.  Should describe the format in 
     unusual cases - null input, etc.

     Cannot use the test data files because they might be empty or need 
     hand-editing 

     Use "<b>LIBGEN</b> reads any normal sequence USAs." if
     appropriate.
-->
<a name="3.0"></a>
<br><br><br><H2> 3.0   INPUT FILE FORMAT         </H2>
The format of the domain alignment file is described in <a href="domainalign.html">DOMAINALIGN documentation</a>. 
<br>If another alignment file is used as input, all of the common file formats are supported.



<!-- OUTPUT FILE FORMAT 
     Description and example(s) of output file formats.  Should provide enough
     information to write and parse the file.  Should describe the format in 
     unusual cases - null input, etc.  
     If the standard description of the avalable report formats is required, 
     use:   #include file="inc/reportformats.ihtml"
     Use "Outputs a graph to the specified graphics device."
     or  "outputs a report format file. The default format is ..."
     if appropriate.
-->
<a name="4.0"></a>
<br><br><br><H2> 4.0   OUTPUT FILE FORMAT         </H2>
The format of the HMM files are described in the HMMER and SAM documentation.
<br>The format of the profile file is described in the <a href="../prophecy.html">prophecy documentation.</a>
The format of the PSSM is described in the BLAST documentation.



<!-- DATA FILES         
     Any data files used (e.g. translation table file, substitution matrix 
     etc.  This includes example data file formats if they are not obvious.
     For a standard description of what data files are and how embossdata can
     be used to inspect and retrieve them, use:
     #include file="inc/localfiles.ihtml" 
-->

<a name="5.0"></a>
<br><br><br><H2> 5.0   DATA FILES                </H2>
LIBGEN require a residue substitution matrix for the generation of certain types of profile.


<!-- USAGE
     Example usage, as run from the command-line.
     Many examples illustrating different behaviours is good.
-->
<a name="6.0"></a>
<br><br><br><H2> 6.0   USAGE                     </H2>
<H3> 6.1   COMMAND LINE ARGUMENTS </H3>
 

<table border cellspacing=0 cellpadding=3 bgcolor="#ccccff">
<tr bgcolor="#FFFFCC">
<th align="left" colspan=2>Standard (Mandatory) qualifiers</th>
<th align="left">Allowed values</th>
<th align="left">Default</th>
</tr>
 
<tr>
<td>[-dafin]<br>(Parameter 1)</td>
<td>This option specifies the location of DAF files (domain alignment files) (input). A 'domain alignment file' contains a sequence alignment of domains belonging to the same SCOP or CATH family. The file is in clustal format annotated with domain family classification information. The files generated by using SCOPALIGN will contain a structure-based sequence alignment of domains of known structure only. Such alignments can be extended with sequence relatives (of unknown structure) by using SEQALIGN.</td>
<td>Directory with files</td>
<td>./</td>
</tr>
 
<tr>
<td>-matrixf</td>
<td>This option specifies the residue substitution matrix. Epprofile for Gribskov profiles or EBLOSUM62 otherwise.</td>
<td>Comparison matrix file in EMBOSS data path</td>
<td>Epprofile for Gribskov type, or EBLOSUM62</td>
</tr>
 
<tr>
<td>-mode</td>
<td>This option specifies the mode of LIBGEN operation. LIBGEN generates one of six types of profile for each alignment. Supported profiles include simple frequency matrices, Gribskov profiles, Hennikoff profiles, hidden Markov models (HMMER package), hidden Markov models (SAM-T2K package) and position-specific scoring matrices.</td>
<td><table><tr><td>1</td> <td><i>(Simple frequency matrix)</i></td></tr><tr><td>2</td> <td><i>(Gribskov profile)</i></td></tr><tr><td>3</td> <td><i>(Henikoff profile)</i></td></tr><tr><td>4</td> <td><i>(Hidden Markov model (HMMER))</i></td></tr><tr><td>5</td> <td><i>(Hidden Markov model (SAM-T2K))</i></td></tr><tr><td>6</td> <td><i>(Position-specific scoring matrix)</i></td></tr></table></td>
<td>1</td>
</tr>
 
<tr>
<td>-threshold</td>
<td>This option specifies the threshold reporting percentage. The threshold reporting percentage is used in the construction of the simple frequency matrix.</td>
<td>Integer from 1 to 100</td>
<td>75</td>
</tr>
 
<tr>
<td>-gapopen</td>
<td>This option specifies the gap insertion penalty. The gap insertion penalty is the score taken away when a gap is created. The best value depends on the choice of comparison matrix. The default value assumes you are using the EBLOSUM62 matrix for protein sequences, and the EDNAFULL matrix for nucleotide sequences.</td>
<td>Any numeric value</td>
<td>3.0</td>
</tr>
 
<tr>
<td>-gapextend</td>
<td>This option specifies the gap extension penalty. The gap extension, penalty is added to the standard gap penalty for each base or residue in the gap. This is how long gaps are penalized. Usually you will expect a few long gaps rather than many short gaps, so the gap extension penalty should be lower than the gap penalty. An exception is where one or both sequences are single reads with possible sequencing errors in which case you would expect many single base gaps. You can get this result by setting the gap open penalty to zero (or very low) and using the gap extension penalty to control gap scoring.</td>
<td>Any numeric value</td>
<td>0.3</td>
</tr>
 
<tr>
<td>[-outdir]<br>(Parameter 2)</td>
<td>This option specifies the location of discriminator files (output). The discriminator files contain one of the supported profiles, including simple frequency matrices, Gribskov profiles, Hennikoff profiles, hidden Markov models (HMMER package), hidden Markov models (SAM-T2K package) and position-specific scoring matrices.</td>
<td>Directory</td>
<td>./</td>
</tr>
 
<tr bgcolor="#FFFFCC">
<th align="left" colspan=2>Additional (Optional) qualifiers</th>
<th align="left">Allowed values</th>
<th align="left">Default</th>
</tr>
 
<tr>
<td colspan=4>(none)</td>
</tr>
 
<tr bgcolor="#FFFFCC">
<th align="left" colspan=2>Advanced (Unprompted) qualifiers</th>
<th align="left">Allowed values</th>
<th align="left">Default</th>
</tr>
 
<tr>
<td colspan=4>(none)</td>
</tr>
 
</table>




<H3> 6.2 EXAMPLE SESSION </H3>
An example of interactive use of LIBGEN is shown below.
<table><td bgcolor="#FFCCFF">
<pre>
Unix %
Generates various types of discriminating elements for each alignment in a
directory.
Location of DAF files (domain alignment files) (input). [./]: /test_data
Residue substitution matrix. [EBLOSUM62]:
Discrimininator type
         1 : Simple frequency matrix
         2 : Gribskov profile
         3 : Henikoff profile
         4 : Hidden Markov model (HMMER)
         5 : Hidden Markov model (SAM-T2K)
         6 : Position-specific scoring matrix
Select type. [1]: 2
Location of discriminator files (output). [./]: test_data/libgen
Unix %
</pre>
</table>

Domain alignment files of file extension .salign (specified in ACD) were read from /test_data. A Gribskov profile was generated and written to /test_data/libgen.  The EBLOSUM62 residue substitution matrix was used.
<br> 
<br>The following command line would achieve the same result.
<br>
<table><td bgcolor="#FFCCFF">
<pre> 
libgen /test_data /test_data/libgen -matrixf EBLOSUM62 -mode 2
</pre> 
</table>

<!-- KNOWN BUGS & WARNINGS
     Bugs that have not yet been fixed, easily missued features, problems
     and caveats etc. Potentially stupid things the program will let you do.
-->
<a name="7.0"></a>
<br><br><br><H2> 7.0   KNOWN BUGS & WARNINGS     </H2>
Be careful to select the appropriate matrix which is not necessarily the suggested default matrix.  You should normally pick Epprofile for Gribskov profiles or EBLOSUM62 otherwise.  
<br><br>A matrix is prompted for but not actually required for HMM generation: this behaviour will be fixed in a future version.






<!-- NOTES
     Important general remarks, including:
       Restrictions.
       Interesting behaviour.
       Useful things you can do with this program.
       Future plans.
       etc.
-->
<a name="8.0"></a>
<br><br><br><H2> 8.0   NOTES                     </H2>
LIBGEN requires a working version of HMMER and SAM-T2K installed on the same machine if the corresponding modes are selected.

<br><br>When running libgen at the HGMP it is essential that the command 'use hmmer' (which runs the script /packages/menu/USE/hmmer) is given before it is run.  
<br><br>When running libgen at the HGMP it is essential that the command 'use samt2k' (which runs the script /packages/menu/USE/samt2k) is given before it is run.  


<H3> 8.1   GLOSSARY OF FILE TYPES    </H3>
<table BORDER CELLSPACING=5 CELLPADDING=5 BGCOLOR="#f5f5ff" >
<tr>
<td><b>FILE TYPE</b></td>
<td><b>FORMAT</b></td>
<td><b>DESCRIPTION</b></td>
<td><b>CREATED BY <b></td>
<td><b>SEE ALSO</b></td>
</tr>
<tr>
<td><b>Domain alignment file </b></td>
<td> DAF format (CLUSTAL-like format with domain classification information). </td>
<td> Contains a sequence alignment of domains belonging to the same SCOP or CATH family.  The file is annotated with domain family classification information.</td>
<td> <a href="domainalign.html">DOMAINALIGN</a> (structure-based sequence alignment of domains of known structure). </td>
<td> DOMAINALIGN alignments can be extended with sequence relatives (of unknown structure) to the family in question by using SEQALIGN. </td>
</tr>
<tr>
<td><b> Hidden Markov models</b></td>
<td> A file containing a hidden Markov model. </td>
<td> Can be generated for SCOP or CATH families by using LIBGEN which uses the HMMER & SAM-T2K packages. </td>
<td> N.A. </td>
</tr>
<tr>
<td><b> Simple frequency matrices, Gribskov profiles, Hennikoff profiles & position-specific scoring matrices</b></td>
<td> A file containing a simple frequency matrix, Gribskov profile, Hennikoff profile or position-specific scoring matrix.  </td>
<td> Can be generated for SCOP or CATH families by using LIBGEN, which uses the BLAST package. </td>
<td> N.A. </td>
</tr>
</table>





<!-- DESCRIPTION
     A complete, non-technical, user-level description of the application.
-->
<a name="9.0"></a>
<br><br><br><H2> 9.0   DESCRIPTION               </H2>
LIBGEN provides a convenient means to generate various types of profile and hidden Markov models from alignments for protein families.  The profiles are descriptive of the family and can be used to identify sequence relatives of the family. 


<!-- ALGORITHM
     A technical description of algorithmic aspects, describing exactly how
     the key aspects of the application work.
-->
<a name="10.0"></a>
<br><br><br><H2> 10.0  ALGORITHM                 </H2>
Functions from the emboss application prophecy have been incorporated.



<!-- RELATED APPLICATIONS
     Other applications that either generate the input, use the output or 
     are in some other way related to the application are described here. 
     (Take this from "Sister applications" in the old documentation)
-->
<a name="11.0"></a>
<br><br><br><H2> 11.0  RELATED APPLICATIONS      </H2>
<table BORDER CELLSPACING=5 CELLPADDING=5 BGCOLOR="#f5f5ff" >
<tr>
<td><b>APPLICATION</b></td>
<td><b>DESCRIPTION</b></td>
</tr>
<tr>
<td><b><a href="domainalign.html">DOMAINALIGN</a> </b></td>
<td> Generates structure-based sequence alignments for nodes in a DCF
      file (domain classification file). </td>
</tr>
<tr>
<td><b><a href="seqalign.html">SEQALIGN</a> </b></td>
<td> Generates a sequence alignment from a seed alignment and a set of
      sequences. </td>
</tr>
<tr>
<td><b><a href="libgen.html">LIBGEN</a> </b></td>
<td>Generates various type of discriminator for each alignment in a
      directory.  </td>
</tr>
<tr>
<td><b><a href="libscan.html">LIBSCAN</a> </b></td>
<td> Generates hits (sequences) from searches of various types of
      discriminator (HMMs, profiles etc) against a sequence database.  
      Or generates hits from screening sequences against a library of 
      such discriminators. </td>
</tr>
<tr>
<td><b><a href="siggen.html">SIGGEN</a> </b></td>
<td>Generates a sparse protein signature from an alignment and residue
     contact data.  </td>
</tr>
<tr>
<td><b><a href="sigscan.html">SIGSCAN</a> </b></td>
<td>  Generates hits (sequences) from scanning a signature against a
     sequence database. </td>
</tr>
</table>





<!-- DIAGNOSTIC ERROR MESSAGES
     Description of error messages or log file, if one is written.
-->
<a name="12.0"></a>
<br><br><br><H2> 12.0  DIAGNOSTIC ERROR MESSAGES </H2>
None.






<!-- AUTHORS -->
<a name="13.0"><br><br><br><H2> 13.0  AUTHORS                   </H2></a>
Jon Ison <a href="mailto:jison@rfcgr.mrc.ac.uk">(jison@rfcgr.mrc.ac.uk)</a>
<br>
MRC Rosalind Franklin Centre for Genomics Research
Wellcome Trust Genome Campus, Hinxton, Cambridge, CB10 1SB, UK
<br><br><i>Based on the original <b>profgen</b> and <b>hmmgen</b> applications written by</i><br>
<br>Ranjeeva Ranasinghe <a href="mailto:rranasin@rfcgr.mrc.ac.uk">(rranasin@rfcgr.mrc.ac.uk)</a>



<!-- REFERENCES
     Quote the paper where the application was first published, described, used etc. 
-->
<a name="14.0"></a>
<br><br><br><H2> 14.0  REFERENCES                </H2>
Please cite the authors and EMBOSS.
<br><br>
<i>Rice P, Bleasby A.J.  2000.  EMBOSS - The European Molecular Biology Open Software Suite.  Trends in Genetics, 15:276-278.  See also http://www.uk.embnet.org/Software/EMBOSS</i>

<H3>14.1 Other useful references  </H3>

<br>

</BODY>
</HTML>
